<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>unstable twin</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta keywords="">
<style>

.CodeMirror {
  height: inherit;
}

.doc-embed {
  padding: 0;
  border: 1px solid #41454E;
  border-radius: 3px;
  margin-bottom: 4px;

  color: #fff;

  .doc-embed-wrapper {
    display: flex;
    align-items: stretch;
    flex-wrap: nowrap;
  }

  .collapse-trigger {
    flex: 0 0 auto;
    display: flex;
    flex-direction: column;
    padding-top: 4px;
    padding-left: 4px;
    cursor: pointer;
    overflow: hidden;

    .threadline {
      flex: 1 1 auto;
      width: 1px;
      background: #27282B;
      transition: 0.2s
      display: block;
      margin: auto;
    }

    &:hover .threadline {
      width: 1px;
      background: #E6E6E6
    }
  }

  svg {
    width: 40px;
    height: 40px;
    cursor: pointer;
    fill: currentColor;
  }

  &.collapsed {
    .collapse-trigger  {
      .threadline {
        display: none;
      }
      svg {
        transform: rotate(-90deg);
      }
    }
    .doc-embed-content {
      display: none;
    }
  }

  .embed-body {
    min-width: 0;
  }

  .doc-embed-header {
    display: flex;
    align-items: center;

    & > div {
      flex: 1;
      min-width: 0;
      padding: 4px 8px 4px 4px;
    }

    h1, a {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    h1 {
      font-size: 24px;
      margin: 0;
    }

    p {
      margin: 0;
    }

    a {
      display: block;
    }

    a > svg {
      margin-right: 5px;
      width: 20px;
      height: 20px;
      vertical-align: middle;
    }
  }

  .doc-embed-content {
    padding: 0 8px;
  }
}

-ms-text-size-adjust: 100%;
-webkit-text-size-adjust: 100%;
line-height: 1.6;
font-family: Lato, -apple-system, BlinkMacSystemFont, Helvetica, Arial, sans-serif;
font-size: 15px;
line-height: 1.6;
word-wrap: break-word;

.dark, .solarizedDark {
  color: #FFF;
}

details {
  display: block;
}

summary {
  display: list-item;
}

a {
  background-color: transparent;
}

a:active,
a:hover {
  outline-width: 0;
}

strong {
  font-weight: inherit;
  font-weight: bolder;
}

h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

img {
  border-style: none;
}

code,
kbd,
pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

input {
  font: inherit;
  margin: 0;
}

input {
  overflow: visible;
}

[type='checkbox'] {
  box-sizing: border-box;
  padding: 0;
}

* {
  box-sizing: border-box;
}

input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

a {
  color: #0366d6;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

strong {
  font-weight: 600;
}

hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

hr:before {
  content: '';
  display: table;
}

hr:after {
  clear: both;
  content: '';
  display: table;
}

table {
  border-collapse: collapse;
  border-spacing: 0;
}

td,
th {
  padding: 0;
}

details summary {
  cursor: pointer;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  margin-bottom: 0;
  margin-top: 0;
}

h1 {
  font-size: 32px;
}

h1,
h2 {
  font-weight: 500;
}

h2 {
  font-size: 24px;
}

h3 {
  font-size: 20px;
}

h3,
h4 {
  font-weight: 500;
}

h4 {
  font-size: 16px;
}

h5 {
  font-size: 14px;
}

h5,
h6 {
  font-weight: 600;
}

h6 {
  font-size: 12px;
}

p {
  margin-bottom: 10px;
  margin-top: 0;
}

blockquote {
  margin: 0;
}

ol,
ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

ol ol,
ul ol {
  list-style-type: lower-roman;
}

ol ol ol,
ol ul ol,
ul ol ol,
ul ul ol {
  list-style-type: lower-alpha;
}

dd {
  margin-left: 0;
}

code,
pre {
  font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier,
    monospace;
  font-size: 12px;
}

pre.CodeMirror,
code.CodeMirror {
  height: auto;
}

pre {
  margin-bottom: 0;
  margin-top: 0;
}

input::-webkit-inner-spin-button,
input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

&:before {
  content: '';
  display: table;
}

&:after {
  clear: both;
  content: '';
  display: table;
}

> :first-child {
  margin-top: 0 !important;
}

> :last-child {
  margin-bottom: 0 !important;
}

a:not([href]) {
  color: inherit;
  text-decoration: none;
}

blockquote,
dl,
ol,
p,
pre,
table,
ul {
  margin-bottom: 16px;
  margin-top: 0;
}

hr {
  background-color: #e1e4e8;
  border: 0;
  height: 1px;
  margin: 16px 0;
  padding: 0;
}

blockquote {
  border-left: 0.25em solid #e1e4e8;
  color: #999999;
  padding: 0 1em;
}

blockquote > :first-child {
  margin-top: 0;
}

blockquote > :last-child {
  margin-bottom: 0;
}

kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  line-height: 1.25;
  margin: 8px 0;
}

h1 {
  margin-top: 32px;
  font-weight: 600;
  font-size: 1.953em;
  margin-bottom: 10px;
}

h2 {
  font-weight: 600;
  font-size: 1.5em;
  margin-top: 16px;
  margin-bottom: 8px;
}

h3 {
  font-weight: 600;
  font-size: 1.25em;
}

h4 {
  font-weight: 400;
  font-size: 1em;
}

h5 {
  font-weight: 400;
  font-size: 0.875em;
}

h6 {
  font-weight: 400;
  color: #6a737d;
  font-size: 0.85em;
}

ol,
ul {
  padding-left: 2em;
}
ol ol,
ol ul,
ul ol,
ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

li {
  word-wrap: break-all;
}

li > p {
  margin-top: 16px;

  &:first-child {
    margin-top: 0;
  }
  &:last-child {
    margin-bottom: 0;
  }
}

li + li {
  margin-top: 0.25em;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

table {
  display: block;
  overflow: auto;
  width: 100%;
}

table th {
  font-weight: 600;
}

table td,
table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #c6cbd1;
}

img {
  display: block;
  max-width: 100%;
  height: auto;
  margin: 15px 0;
  box-sizing: content-box;
}

img[align='right'] {
  padding-left: 20px;
}

img[align='left'] {
  padding-right: 20px;
}

code {
  background-color: rgba(27, 31, 35, 0.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: 0.2em 0.4em;
}

p code,
li code
{
  padding: 2px;
  border-width: 1px;
  border-style: solid;
  border-radius: 5px;
}

pre {
  word-wrap: normal;
}

pre > code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.highlight {
  margin-bottom: 16px;
}

.highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.highlight pre,
pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier,
    monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

:checked + .radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.task-list-item {
  position: relative;
  list-style-type: none;
  height: fit-content;
  min-height: 25px;
}

.task-list-item + .task-list-item {
  margin-top: 3px;
}

.task-list-item input {
  margin: 0 0.2em 0.25em -1.6em;
  vertical-align: middle;
}

.task-list-item input[type=checkbox] {
  position: absolute;
  top: 6px;
}

hr {
  border-bottom-color: #eee;
}

.dark p code,
.dark li code
{
  background-color: rgba(255,255,255,0.12);
  border-color: rgba(255,255,255,0.3);
  color: #5580DC;
}

.auto p code,
.auto li code
{
  background-color: #F9F9F9;
  border-color: rgba(0,0,0,0.26);
  color: #5580DC;
}

.light p code,
.light li code
{
  background-color: #F9F9F9;
  border-color: rgba(0,0,0,0.26);
  color: #5580DC;
}

.sepia p code,
.sepia li code
{
  background-color: #efe8d6;
  border-color: rgba(0,0,0,0.26);
  color: #F77942;
}

.solarizedDark p code,
.solarizedDark li code
{
  background-color: rgba(255,255,255,0.12);
  border-color: rgba(255,255,255,0.3);
  color: #36abe3;
}
</style>
<link rel="stylesheet" href="https://boostnote.io/app/codemirror/theme/codemirror.css">
<link rel="stylesheet" href="https://boostnote.io/app/katex/katex.min.css">
<link rel="stylesheet" href="https://boostnote.io/app/remark-admonitions/classic.css">
<link rel="stylesheet" href="https://boostnote.io/app/codemirror/theme/material-darker.css">
</head>
<body>
<h3>Unstable machine from tryhackme and its a great and undertaking room. so let's begain.....</h3>
<h1>Namp Scan.</h1>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/0b3edb4309cefd3ca626614bc9cdb6ec7b79c25b786ea71817dac1e34bcfd5e4-Nmap%20Result.png"></p>
<p>We can clearly see there is nothing much more for explore and see what going on. there is simple web page runnging on port 80. And ssh on port 22 which one is by defualt.</p>
<h3>In Enumeration there is one key to look into web directory so let's start..</h3>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/a416ca6c2e788534b99250b5b4d3ab2523fa0463bccb6f5a174dd0f323807e5f-Directory%20Scan.png">
web can clearly see there is just one directory in /info but we goes to that we can see there is just one message.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/c5b5fae0821ea4a66b0bd586e7c755890b55dfba61f40d68d4569e110e29f1f7-burp11.png"></p>
<p>It means there is game play off APIs we need to just this request into burp so we can get a more information about what's actually going on request.</p>
<h3>Interpect request throw burp..</h3>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/09c0d7b4d9bc989a13146473c11899afbd33f81ac07ab4e4f7379ae744f6db6d-burp1.png"></p>
<p>It's look normal but when can see It's here build number too. but when I enter on THM It's say wrong flag so I'm try another way but I interpect request again It's changed. I mean build number change by send request again and agian.
<img src="https://boostnote.io/api/teams/jShH61kcp/files/d7abc2ebf46c27ac9bcc3e0f5d9fc6e1e005bdaf837f8404839d5697c9ab4765-burp2.png"></p>
<p>When executed multiple times, this request returns different build numbers and server names. It seems like two servers run on the host. You can observe this by observing the HTTP header for both scans.</p>
<pre class="cm-s-default CodeMirror"><code>curl -X POST http://10.10.35.201/api
&#x3C;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
&#x3C;title>405 Method Not Allowed&#x3C;/title>
&#x3C;h1>Method Not Allowed&#x3C;/h1>
&#x3C;p>The method is not allowed for the requested URL.&#x3C;/p>
</code></pre>
<p>  When I curl /api directory It's say there is one more directory named api i guess by searching about "How API work". so I'm curious to see why api directory not appear on scans. Then I try multiple thing by changing wordlist but It's not working. after so much hard work I find this
<img src="https://boostnote.io/api/teams/jShH61kcp/files/ae6ca12a950cb414684b946733c2c3e6701bee014ef4f5d9ec16606a34e7ef62-Untitled.png">
Defualt configuration of dirseach </p>
<p>We can clearly see by Defualt dirsearch support some respons code and also when I take a close look on curl request It's say <code>405 Method Not Allowed</code>. It mean that api page respons code is 405 and we can try ffuf becasue It's fast and simple..</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/10de420ef256a24baefaeb4eec985ae1e3d6d5040b834eb1902ca18e4a6d1d79-ffuf%20scan%202.png"></p>
<p>Found this /api directory and now let's move to Fuzz another directory in /api address..</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/9297d9d15aeab1b43417980765f30159cd81855e5c183de936508689a6469a50-ffuf%20Scan.png"></p>
<p>A login page I found..</p>
<pre class="cm-s-default CodeMirror"><code>curl -X POST http://10.10.35.201/api/login
"The username or password passed are not correct."
</code></pre>
<h2>SQL Injection Using Curl</h2>
<p>There is a hard part in this room so started try another another sql payloads for discover tables. And the end found pdf on exploit-db </p>
<blockquote>
<p><a href="https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf">https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf</a> </p>
</blockquote>
<p>Lot's of hard request and using to much payloads I get payloads to discover verion </p>
<blockquote>
<p>P : UNION SELECT 1,sqlite_version()--</p>
</blockquote>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/94de3b5cb39f8f27a5456e9edf3bbc9f035cbb3dd3c28e4ac09866934526ddfc-curl%20for%20Version.png"></p>
<p>Now expose the tables..</p>
<blockquote>
<p>P : union SELECT tbl<em>name FROM sqlite_master  WHERE type='table' and tbl_name NOT like 'sqlite</em>%</p>
</blockquote>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/89701ea4f119947079d3406a1cda172b98419e511becc541f205ab422fd01f03-curl%20for%20checking%20table_names.png"></p>
<p>Let's started to look into users first..</p>
<blockquote>
<p>P : UNION SELECT username, password FROM users--</p>
</blockquote>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/286bf918ac53c919f4b515a8b8a7801153787db63c8184e45d5cfdf207f6fe5b-curl%20for%20user%20tabe.png"></p>
<p>Now take a look in notes to find ssh cridential.</p>
<blockquote>
<p>P : Union ALL SELECT 1,notes FROM notes---</p>
</blockquote>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/844b03fe32b7e7199a8d9765635facdbcba454a01e1a9181138139b637894795-curl%20for%20notes%20table.png"></p>
<p>So yeah It's ssh cred and is in hash form. we first to crack down this..</p>
<h2>HASH CRACKING</h2>
<p>using some identifire we can see this is a SHA-512 hash.
We can crack this using <code>John</code> and wordlist <code>rockyou.txt</code></p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/1222d2d7ec8b01edaa09e9e8437023b8c486dafad852c66ce7cf1c46290a280c-hash%20cracking.png"></p>
<p>we get a ssh password of user marry_ann. and let's jump into ssh.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/ae46423533cc272afce3fd8a146b3635a2fb56521142f4b8ea4c00d917952ae5-ssh%20welcome.png"></p>
<p>Get a ssh welcome and user flag too.</p>
<p>Now time to final flag and nor there is no flag for root..</p>
<p>Hint file in home directory server_notes.txt </p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/9e5d1e4d78a91464b17894ec3285e4f25f68f54acbb341ac38011c88713cd926-find_in_note_ssh.png"></p>
<p>it's says about one directory which contains all family pictures so let's find directory and found one /opt.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/f12f4031cd8d400161c434afc39b97919860ae66970d6456ee98762ac1cea2c5-photo%20album.png"></p>
<p>yeah after looking we can clearly think this is a steganography. but the biggest prob is share those files in machine for futher process.</p>
<p>And I tried different things like <code>python,Apache</code> and many other methods to but failed! </p>
<p>Moving to looking what indside main_5000.py we found this to take all images to my machine.</p>
<pre class="cm-s-default CodeMirror"><code>@app.route('/get_image')
def get_image():
    if request.args.get('name').lower() == 'vincent':
        filename = 'Twins-Danny-DeVito.jpg'
        return send_file(filename, mimetype='image/gif')
    elif request.args.get('name').lower() == 'julias':
        filename = 'Twins-Arnold-Schwarzenegger.jpg'
        return send_file(filename, mimetype='image/gif')
    elif request.args.get('name').lower() == 'mary_ann':
        filename = 'Twins-Bonnie-Bartlett.jpg'
        return send_file(filename, mimetype='image/gif')
    return '', 404

</code></pre>
<p>And yeah we can see there is /get_image?name= peremeter to get those images according to these code. after using some google research I get how to curl these images in my machine.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/5043009c0e3b54c7598d6805be84779d5b0aaffda5373f06437b2245427b71bb-geting%20those%20images%20for%20steghide.png"></p>
<p>Using these I can get all images.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/3aa37468142520da1326aa63e2c8a794380c07f3c5d51eba0726a9d9c14189c5-all%20image%20in%20my%20machine.png"></p>
<h2>steganography</h2>
<p>Time to get a final flag.</p>
<p>try steghide to get a what hidden message inside in a images.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/b000330bba861fc3ca66bdca7ba73c93c2518636741c53b5c2990bc0e1137f69-steghide%20all.png"></p>
<p>At last extracting I found notes.txt file on every images and there is a all notes file with some hash and line denoted by colors like this.</p>
<pre class="cm-s-default CodeMirror"><code>Red - 1DVsdb2uEE0k5HK4GAIZ

</code></pre>
<p>One notes file like named notes.txt seems there is some hint to crack those hash.</p>
<blockquote>
<p>Hint : You need to find all my children and arrange in a rainbow!</p>
</blockquote>
<p>It means arrang all images rainbow colour like this.
<img src="https://boostnote.io/api/teams/jShH61kcp/files/045bfce6b248f7162d164100daf9a31e097604ddf1e95deb416d80a096a4e380-Untitled.png"></p>
<p>After containing all images in rainbow color sequence.</p>
<blockquote>
<p>hash : 1DVsdb2uEE0k5HK4GAIZPS0Mby2jomUKLjvQ4OSwjKLNAAeCdl2J8BCRuXVXeVYvs6J6HKpZWPG8pfeHoNG1</p>
</blockquote>
<p>It's base62 hash decode this using CyberChief and get a final.</p>
<p><img src="https://boostnote.io/api/teams/jShH61kcp/files/cc2ea403b1bc5fde8cfef6d436d419517854b296ba3f02d018bc1c52192646a0-Untitled.png"></p>
</body>
</html>
